---
title: "Take-home Excercise 1"
site: distill::distill_website
---
# 1.0 Introduction

This is a visual analysis project which uses the data from [VAST Challenge 2022](https://vast-challenge.github.io/2022/). 

- **Data: Participants.csv**: Contains information about the residents of Engagement,OH that have a greed to participate in this study.

- Packages: tidyverse, ggdist, gghalves
The data is processed by using appropriate **tidyverse** family of packages and the statistical graphics is prepared using **ggplot2** and its **extensions**.

```{r, setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE,
                      eval=TRUE,
                      warning=FALSE,
                      message=FALSE)
```

```{r layout="l-body-outset", preview=TRUE}
packages = c('tidyverse', 'ggdist', 'ggridges',
             'patchwork', 'ggthemes', 'hrbrthemes',
             'ggrepel', 'ggforce')
for(p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p, character.only = T)
}
```

# Read-in data

Firstly, we need to import our dataset. The source file is in csv format, and consists of . Hence, read_csv() of the readr package is used to import the data.It has 7 attributes.

- participantId: int
- householdSize: int
- haveKids(boolean):whether there arechildrenlivingintheparticipant’shousehold
- age: (integer):participant’s age in years at the start of the study 
- educationLevel(stringfactor):the participant’s education level,one of: {"Low","HighSchoolOrCollege","Bachelors","Graduate"}
- interestGroup(char):a char representing the participant’s stated primary interest
- joviality(float):a value ranging from[0,1] indicating the participant’s overall happiness level at the start of the study
```{r layout="l-body-outset", preview=TRUE}
# Reading the csv file as a tbl_df
participants_data <- read_csv("./data/Participants.csv")
# Inspecting the structure of the dataset
# str(participants_data)
str(participants_data)
```

# Joviality vs educationLevel
As the educationLevel goes up from highSchoolOrCollege to graduate, people are generally happier. 
```{r}
participants_data$educationLevel <-factor(participants_data$educationLevel,ordered=TRUE,levels=c('Low','HighSchoolOrCollege',"Bachelors","Graduate"))
agg_happy <- participants_data %>% 
  select(c("educationLevel","joviality")) %>%
  group_by(educationLevel) %>% 
  summarise(joviality=mean(joviality))

happy_sorted <- agg_happy %>%
  arrange(desc(educationLevel))

p1=ggplot(participants_data, aes(x = joviality, y = educationLevel, fill = educationLevel)) +
  geom_density_ridges(geom = "density_ridges_gradient", 
                      calc_ecdf = TRUE,
                      quantiles = 4, 
                      quantile_lines = TRUE,
                      alpha = .2) +
  theme_ridges() + 
  scale_fill_viridis_d(name = "Quartiles")+
  ggtitle("Distribution of joviality \n in different Education Level")+
  theme(plot.title = element_text(size = 12))
p2=ggplot(data=happy_sorted,
      aes(y = joviality,
      x= educationLevel,
      group=1)) +
  geom_line(linetype = "dashed",color='black',arrow = arrow(type = "closed"))+
  geom_point(stat = "identity",
             position = "identity")+
  ggtitle("Change of average joviality \n when Education Level increase")+
  theme(plot.title = element_text(size = 12))
p1/p2
```
```{r}
ggplot(participants_data, aes(x = joviality, y = educationLevel, fill = educationLevel)) +
  geom_density_ridges(geom = "density_ridges_gradient", 
                      calc_ecdf = TRUE,
                      quantiles = 4, 
                      quantile_lines = TRUE,
                      alpha = .2) +
  theme_ridges() + 
  scale_fill_viridis_d(name = "Quartiles")+
  ggtitle("Distribution of joviality \n in different Education Level")+
  theme(plot.title = element_text(size = 12))
```

```{r}
table=table
ggplot(data=participants_data, 
       aes(y = age, x= haveKids)) + 
  geom_boxplot() + 
  geom_point(stat="summary", 
             fun.y="mean", 
             colour ="red", 
             size=4)
```

```{r}
devtools::install_github("psyteachr/introdataviz")
ggplot(participants_data, 
       aes(x = educationLevel, 
           y = age, 
           fill = haveKids)) + 
  introdataviz::geom_split_violin(alpha = .4, 
                                  trim = FALSE) + 
  geom_boxplot(width = .2, 
               alpha = .6, 
               fatten = NULL, 
               show.legend = FALSE) + 
  stat_summary(fun.data = "mean_se", 
               geom = "pointrange", 
               show.legend = F, 
               position = position_dodge(.175)) + 
  scale_y_continuous(breaks = seq(0, 100, 20), 
                      limits = c(0, 100)) + 
  scale_fill_brewer(palette = "Dark2", 
                    name = "Has Child")

```

```{r}
participants_data$age_state = ifelse(
    test = participants_data$age > 30,
    yes = "Old",
    no = "Young"
)
# Make it a factor
participants_data$age_state = factor(
    participants_data$age_state,
    levels = c("Old", "Young")
)
```

# Young people tend to be happier than old people.
```{r}
p1 = ggplot(data=subset(participants_data,age_state=='Young'), 
       aes(x = joviality)) + 
  geom_density() +
  ggtitle("Distribution of joviality for young people")+
  theme(plot.title = element_text(size = 10))
p2 = ggplot(data=subset(participants_data,age_state=='Old'), 
       aes(x = joviality)) + 
  geom_density() +
  ggtitle("Distribution of joviality for old people")+
  theme(plot.title = element_text(size = 10))
p3 = ggplot(data=participants_data,
aes(x= joviality,
fill = age_state)) +
geom_density(alpha=0.2) +
  annotate("text", x = 0.8, y = 1.2, label = "Young people tend\n to be happier",size=3,color='#4682B4') + 
  ggtitle("Distribution of joviality in different Age Groups")+
  theme(plot.title = element_text(size = 10))
(p1 / p2) | p3
```
#
```{r layout="l-body-outset", preview=TRUE}
ggplot(data=participants_data,
aes(y = age,
x= educationLevel)) +
geom_boxplot()
```
Violin plot for 
```{r layout="l-body-outset", preview=TRUE}
ggplot(data=participants_data,
aes(y = age,x= interestGroup)) +geom_violin()+
ggtitle("Distribution of Age in different Interest Group")
```