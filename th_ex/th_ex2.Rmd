---
title: "Take Home Exercise 2"
author:
- name: "Huang Anni"
  affiliation: "Singapore Management University"
description: |
  Peer study
output:
  distill::distill_article:
    toc: true
    toc_depth: 3
---

# The task
In this take-home exercise 2, we are required to:

- select one of the Take-home Exercise 1 prepared by your classmate([Yu Di](https://yudiva.netlify.app/exe1)),
- critic the submission in terms of **clarity and aesthetics**, and
- **remake the original design** by using the data visualisation principles and best practice you had learned in Lesson 1 and 2.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      eval = TRUE,
                      warning = FALSE, 
                      message = FALSE)
```

## Introduction
  
This exercise requires us to apply the skills you had learned in Lesson 1 and Hands-on Exercise 1 to reveal the demographic of the city of Engagement, Ohio USA by using appropriate static statistical graphics methods. The data should be processed by using appropriate tidyverse family of packages and the statistical graphics must be prepared using ggplot2 and its extensions.
  
```{r include=FALSE}
packages = c('tidyverse', 'ggplot2', 'dplyr')

for(p in packages) {
  if(!require(p, character.only = T)) {
    install.packages(p)
  }
  library(p, character.only = T)
}
```
  
## Load Data

```{r load data, echo=TRUE}
library(tidyverse)
library(ggplot2)
data <- read_csv('./data/Participants.csv')
glimpse(data)
```

## Graphics with ggplot2

The origional Plot:
- Athetic: 
- Cleartivity

```{r age distribution, echo=TRUE}
ggplot(data=data) + aes(x=age) +
  geom_histogram(bins=20, boundary=60, color="black", fill="grey") +
  ggtitle("Distribution of Participants' Age")
```
The changed version:
```{r}
brks <- c(17, 20, 25, 30, 35, 40, 45, 50, 55, 60)
grps <- c('20 & Below', '21-25', '26-30', '31-35', '36-40', '41-45', 
          '46-50', '51-55', '56-60')

# data$Age_Group <- cut(data$Age, breaks=brks, labels = grps)
```

```{r, echo=TRUE}
ggplot(data=data, aes(x=age, fill=haveKids)) +
  geom_histogram(bins=100, color='gray30')

ggplot(data=data, aes(x=age, fill=educationLevel)) +
  geom_histogram(bins=20, color='gray30')


d <- data
d_bg <- d[, -5]
ggplot(d, aes(x = age, fill = educationLevel)) + 
  geom_histogram(data=d_bg, fill="grey", alpha=.5) +
  geom_histogram(colour="black") + 
  facet_wrap(~ educationLevel) + 
  guides(fill = FALSE) + 
  theme_bw()
```

To see more about joviality:

```{r echo=TRUE}
ggplot(data=data, aes(x = joviality, colour=haveKids)) + geom_density()

ggplot(data=data, aes(y = joviality, x= haveKids)) + 
  geom_violin(fill='light blue') + 
  geom_boxplot(notch=TRUE) +
  stat_summary(geom = "point", fun="mean", colour ="red", size=4)

ggplot(data=data, aes(x= joviality)) + geom_histogram(bins=20) + 
  facet_wrap(~ educationLevel)

ggplot(data=data, aes(y = joviality, x= interestGroup)) + geom_boxplot() +
  facet_grid(educationLevel ~.)

dpp <- data %>%
  group_by(age) %>%
  summarise(joviality = mean(joviality))
ggplot(data=dpp, aes(x=age, y=joviality)) + geom_point() +
  coord_cartesian(xlim=c(20, 60), ylim=c(0, 1)) + 
  geom_hline(yintercept=0.5, linetype="dashed", color="grey60", size=1) +  
  geom_vline(xintercept=40, linetype="dashed", color="grey60", size=1)
```


Now, we can just find out the counts of householdSize types:


```{r}
ggplot(data=data, aes(x=householdSize)) + geom_bar() + coord_flip()
```





